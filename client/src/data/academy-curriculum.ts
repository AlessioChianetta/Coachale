export interface AcademyLesson {
  id: string;
  moduleId: string;
  stepNumber: number;
  title: string;
  description: string;
  duration: string;
  guiddeEmbedUrl: string | null;
  configLink: string;
}

export interface AcademyModule {
  id: string;
  title: string;
  emoji: string;
  tagline: string;
  color: string;
  lessons: AcademyLesson[];
}

export const ACADEMY_MODULES: AcademyModule[] = [
  {
    id: 'setup_base',
    title: 'Setup Base',
    emoji: 'âš™ï¸',
    tagline: 'Configura le fondamenta della piattaforma',
    color: 'slate',
    lessons: [
      {
        id: 'vertex_ai',
        moduleId: 'setup_base',
        stepNumber: 1,
        title: 'AI Backend (Vertex AI)',
        description: 'Collega Google Vertex AI per abilitare tutte le funzioni di intelligenza artificiale: agenti, email, idee e molto altro.',
        duration: '8 min',
        guiddeEmbedUrl: null,
        configLink: '/consultant/api-keys-unified',
      },
      {
        id: 'twilio',
        moduleId: 'setup_base',
        stepNumber: 2,
        title: 'Twilio + WhatsApp Business',
        description: 'Collega il tuo numero WhatsApp Business tramite Twilio per ricevere e inviare messaggi automatici ai tuoi lead e clienti.',
        duration: '10 min',
        guiddeEmbedUrl: null,
        configLink: '/consultant/api-keys-unified?tab=twilio',
      },
      {
        id: 'smtp',
        moduleId: 'setup_base',
        stepNumber: 3,
        title: 'Email SMTP',
        description: 'Configura il server SMTP per inviare email transazionali, riepilogative e di nurturing direttamente dalla piattaforma.',
        duration: '6 min',
        guiddeEmbedUrl: null,
        configLink: '/consultant/smtp-settings',
      },
      {
        id: 'google_calendar',
        moduleId: 'setup_base',
        stepNumber: 4,
        title: 'Google Calendar',
        description: 'Collega il tuo calendario Google per sincronizzare automaticamente gli appuntamenti con i clienti e abilitare il booking AI.',
        duration: '5 min',
        guiddeEmbedUrl: null,
        configLink: '/consultant/calendar',
      },
    ],
  },
  {
    id: 'acquisisci_lead',
    title: 'Acquisisci Lead',
    emoji: 'ðŸŽ¯',
    tagline: 'Attira e qualifica i tuoi potenziali clienti',
    color: 'blue',
    lessons: [
      {
        id: 'lead_import',
        moduleId: 'acquisisci_lead',
        stepNumber: 5,
        title: 'Import Lead da API Esterne',
        description: 'Configura le API per importare automaticamente lead da CRM, form o altre fonti esterne nel tuo database.',
        duration: '8 min',
        guiddeEmbedUrl: null,
        configLink: '/consultant/api-keys-unified?tab=lead-import',
      },
      {
        id: 'agent_inbound',
        moduleId: 'acquisisci_lead',
        stepNumber: 6,
        title: 'Agente Inbound',
        description: 'Crea un agente AI che risponde automaticamente ai lead in entrata su WhatsApp, qualificandoli prima della consulenza.',
        duration: '12 min',
        guiddeEmbedUrl: null,
        configLink: '/consultant/whatsapp',
      },
      {
        id: 'whatsapp_template',
        moduleId: 'acquisisci_lead',
        stepNumber: 7,
        title: 'Template WhatsApp Approvato',
        description: 'Crea e fatti approvare almeno un template da Twilio per inviare messaggi proattivi ai tuoi lead.',
        duration: '10 min',
        guiddeEmbedUrl: null,
        configLink: '/consultant/whatsapp-templates',
      },
      {
        id: 'agent_public_link',
        moduleId: 'acquisisci_lead',
        stepNumber: 8,
        title: 'Link Pubblico Agente',
        description: 'Genera un link pubblico per permettere ai clienti di iniziare una conversazione con il tuo agente AI via WhatsApp.',
        duration: '5 min',
        guiddeEmbedUrl: null,
        configLink: '/consultant/whatsapp-agents-chat',
      },
      {
        id: 'instagram',
        moduleId: 'acquisisci_lead',
        stepNumber: 9,
        title: 'Instagram Direct Messaging',
        description: 'Collega il tuo account Instagram Business per gestire automaticamente i messaggi diretti con AI.',
        duration: '8 min',
        guiddeEmbedUrl: null,
        configLink: '/consultant/api-keys-unified?tab=instagram',
      },
      {
        id: 'whatsapp_ai',
        moduleId: 'acquisisci_lead',
        stepNumber: 10,
        title: 'WhatsApp AI Personale',
        description: 'Configura le chiavi Gemini per abilitare le risposte AI personalizzate sui tuoi agenti WhatsApp.',
        duration: '6 min',
        guiddeEmbedUrl: null,
        configLink: '/consultant/api-keys-unified',
      },
    ],
  },
  {
    id: 'vendi_converti',
    title: 'Vendi & Converti',
    emoji: 'ðŸ’°',
    tagline: 'Trasforma i lead in clienti paganti',
    color: 'violet',
    lessons: [
      {
        id: 'stripe_connect',
        moduleId: 'vendi_converti',
        stepNumber: 11,
        title: 'Stripe â€” Pagamenti',
        description: 'Collega Stripe per gestire pagamenti, abbonamenti e incassi automatici direttamente dalla piattaforma.',
        duration: '8 min',
        guiddeEmbedUrl: null,
        configLink: '/consultant/whatsapp?tab=licenses',
      },
      {
        id: 'agent_outbound',
        moduleId: 'vendi_converti',
        stepNumber: 12,
        title: 'Agente Outbound',
        description: "Crea un agente AI per le campagne di contatto proattivo verso i lead: l'agente scrive lui, tu chiudi.",
        duration: '12 min',
        guiddeEmbedUrl: null,
        configLink: '/consultant/whatsapp',
      },
      {
        id: 'agent_consultative',
        moduleId: 'vendi_converti',
        stepNumber: 13,
        title: 'Agente Consulenziale',
        description: 'Crea un agente specializzato per supporto avanzato, rispondendo a domande complesse con la knowledge base.',
        duration: '10 min',
        guiddeEmbedUrl: null,
        configLink: '/consultant/whatsapp',
      },
      {
        id: 'first_campaign',
        moduleId: 'vendi_converti',
        stepNumber: 14,
        title: 'Prima Campagna Marketing',
        description: 'Lancia la tua prima campagna WhatsApp per contattare i lead automaticamente con messaggi personalizzati AI.',
        duration: '15 min',
        guiddeEmbedUrl: null,
        configLink: '/consultant/campaigns',
      },
      {
        id: 'summary_email',
        moduleId: 'vendi_converti',
        stepNumber: 15,
        title: 'Email Riassuntiva Post-Consulenza',
        description: "Invia la tua prima email riassuntiva dopo una consulenza: l'AI genera automaticamente il recap per il cliente.",
        duration: '5 min',
        guiddeEmbedUrl: null,
        configLink: '/consultant/appointments',
      },
    ],
  },
  {
    id: 'automazioni_ai',
    title: 'Automazioni AI',
    emoji: 'ðŸ¤–',
    tagline: 'La piattaforma lavora per te 24/7',
    color: 'indigo',
    lessons: [
      {
        id: 'ai_autonomo',
        moduleId: 'automazioni_ai',
        stepNumber: 16,
        title: 'AI Autonomo',
        description: "Attiva il sistema AI autonomo: l'AI pianifica e completa task automaticamente ogni giorno senza intervento manuale.",
        duration: '10 min',
        guiddeEmbedUrl: null,
        configLink: '/consultant/ai-autonomy',
      },
      {
        id: 'email_journey',
        moduleId: 'automazioni_ai',
        stepNumber: 17,
        title: 'Email Journey',
        description: "Configura l'automazione email post-consulenza: bozze o invio automatico con template personalizzati dall'AI.",
        duration: '10 min',
        guiddeEmbedUrl: null,
        configLink: '/consultant/ai-config?tab=ai-email',
      },
      {
        id: 'nurturing_emails',
        moduleId: 'automazioni_ai',
        stepNumber: 18,
        title: 'Email Nurturing 365',
        description: "Genera 365 email automatiche per nutrire i tuoi lead nel tempo e mantenerli coinvolti fino alla decisione d'acquisto.",
        duration: '12 min',
        guiddeEmbedUrl: null,
        configLink: '/consultant/ai-config?tab=lead-nurturing',
      },
      {
        id: 'email_hub',
        moduleId: 'automazioni_ai',
        stepNumber: 19,
        title: 'Email Hub',
        description: 'Collega il tuo account email per gestire inbox, invii automatici e risposte AI direttamente dalla piattaforma.',
        duration: '10 min',
        guiddeEmbedUrl: null,
        configLink: '/consultant/email-hub',
      },
      {
        id: 'voice_calls',
        moduleId: 'automazioni_ai',
        stepNumber: 20,
        title: 'Chiamate Voice (Alessia AI)',
        description: "Completa una chiamata vocale AI con Alessia: l'agente chiama i lead, qualifica e prenota appuntamenti in autonomia.",
        duration: '8 min',
        guiddeEmbedUrl: null,
        configLink: '/consultant/voice-calls',
      },
      {
        id: 'google_calendar_agents',
        moduleId: 'automazioni_ai',
        stepNumber: 21,
        title: 'Calendario Agenti AI',
        description: 'Collega Google Calendar ai tuoi agenti per permettere loro di prenotare appuntamenti in autonomia durante le conversazioni.',
        duration: '8 min',
        guiddeEmbedUrl: null,
        configLink: '/consultant/whatsapp',
      },
    ],
  },
  {
    id: 'contenuti_corsi',
    title: 'Contenuti & Corsi',
    emoji: 'ðŸ“š',
    tagline: 'Educa i clienti e posizionati come esperto',
    color: 'amber',
    lessons: [
      {
        id: 'knowledge_base',
        moduleId: 'contenuti_corsi',
        stepNumber: 22,
        title: 'Base di Conoscenza',
        description: "Carica i tuoi documenti (PDF, Word, testo) per alimentare l'AI con informazioni specifiche del tuo business.",
        duration: '10 min',
        guiddeEmbedUrl: null,
        configLink: '/consultant/knowledge-documents',
      },
      {
        id: 'first_course',
        moduleId: 'contenuti_corsi',
        stepNumber: 23,
        title: 'Primo Corso',
        description: 'Crea il tuo primo corso formativo per i clienti: struttura lezioni, aggiungi materiali e assegna ai clienti.',
        duration: '15 min',
        guiddeEmbedUrl: null,
        configLink: '/consultant/university',
      },
      {
        id: 'first_exercise',
        moduleId: 'contenuti_corsi',
        stepNumber: 24,
        title: 'Primo Esercizio',
        description: "Crea il tuo primo esercizio pratico: assegnalo ai clienti e monitora lo svolgimento con feedback AI.",
        duration: '10 min',
        guiddeEmbedUrl: null,
        configLink: '/consultant/exercises',
      },
      {
        id: 'agent_ideas',
        moduleId: 'contenuti_corsi',
        stepNumber: 25,
        title: 'Idee AI per gli Agenti',
        description: "Usa l'AI per generare idee creative su come personalizzare i tuoi agenti e migliorare le conversioni.",
        duration: '8 min',
        guiddeEmbedUrl: null,
        configLink: '/consultant/whatsapp?tab=ideas',
      },
      {
        id: 'more_templates',
        moduleId: 'contenuti_corsi',
        stepNumber: 26,
        title: 'Libreria Template WhatsApp',
        description: 'Espandi la tua libreria di template WhatsApp per coprire tutti gli scenari di comunicazione automatica.',
        duration: '8 min',
        guiddeEmbedUrl: null,
        configLink: '/consultant/whatsapp-templates',
      },
    ],
  },
  {
    id: 'avanzato',
    title: 'Avanzato',
    emoji: 'ðŸš€',
    tagline: 'FunzionalitÃ  premium per massimizzare i risultati',
    color: 'rose',
    lessons: [
      {
        id: 'turn_config',
        moduleId: 'avanzato',
        stepNumber: 27,
        title: 'Video Meeting (TURN Server)',
        description: 'Configura Metered.ca per videochiamate WebRTC affidabili e sicure con i tuoi clienti, senza dipendenze esterne.',
        duration: '8 min',
        guiddeEmbedUrl: null,
        configLink: '/consultant/api-keys-unified?tab=video-meeting',
      },
    ],
  },
];

export const ACADEMY_LESSONS_FLAT: AcademyLesson[] = ACADEMY_MODULES.flatMap(m => m.lessons);

export const LESSON_BY_ID: Record<string, AcademyLesson> = Object.fromEntries(
  ACADEMY_LESSONS_FLAT.map(l => [l.id, l])
);

export const WIZARD_TO_ACADEMY_ID: Record<string, string> = {
  twilio_config: 'twilio',
  approved_template: 'whatsapp_template',
  inbound_agent: 'agent_inbound',
  public_agent_link: 'agent_public_link',
  instagram_dm: 'instagram',
  outbound_agent: 'agent_outbound',
  consultative_agent: 'agent_consultative',
  first_summary_email: 'summary_email',
  video_meeting: 'turn_config',
  ai_ideas: 'agent_ideas',
  google_calendar_consultant: 'google_calendar',
  whatsapp_template: 'more_templates',
  lead_import: 'lead_import',
  first_campaign: 'first_campaign',
  stripe_connect: 'stripe_connect',
  ai_autonomo: 'ai_autonomo',
  email_journey: 'email_journey',
  nurturing_emails: 'nurturing_emails',
  email_hub: 'email_hub',
  voice_calls: 'voice_calls',
  first_course: 'first_course',
  first_exercise: 'first_exercise',
  knowledge_base: 'knowledge_base',
  smtp: 'smtp',
  google_calendar_agents: 'google_calendar_agents',
  vertex_ai: 'vertex_ai',
};
