<include>
  <extension name="alessia_ai_9999_public">
    <condition field="destination_number" expression="^(\+?3[0-9]{8,12}|[0-9]{4,12})$">
      <action application="answer"/>
      <action application="sleep" data="500"/>
      <action application="playback" data="tone_stream://%(200,0,800)"/>
      
      <action application="set" data='STREAM_EXTRA_HEADERS={"Authorization":"Bearer 7a8fad4d5ad94fe3bc342c1c1799b5ea"}'/>
      
      <action application="set" data="play_stream_name=websocket_audio"/>
      <action application="set" data="write_stream_name=websocket_audio"/>

      <action application="set" data="as_res=${api(uuid_audio_stream ${uuid} start ws://127.0.0.1:9090?call_id=${uuid}&amp;caller_id=${caller_id_number}&amp;called_number=${destination_number}&amp;codec=L16&amp;sample_rate=16000&amp;bidirectional=true&amp;buffer_size=1024)}"/>
      
      <action application="playback" data="local_stream://default"/>
      
    </condition>
  </extension>
</include>
