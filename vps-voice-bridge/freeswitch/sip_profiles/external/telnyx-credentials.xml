<!--
  ================================================================
  Gateway: Telnyx - Autenticazione con Credenziali (Credentials)
  ================================================================
  
  QUANDO USARE QUESTO FILE:
  Usa questo gateway quando il tuo VPS ha un IP dinamico o
  quando non puoi/vuoi configurare l'IP auth su Telnyx.
  FreeSWITCH si registrerà periodicamente con username e password.
  
  SETUP RICHIESTO SU TELNYX:
  1. Vai su https://portal.telnyx.com → Networking → SIP Connections
  2. Crea una nuova connessione "Credential Authentication"
  3. Telnyx genererà username e password SIP
  4. Sostituisci TELNYX_SIP_USERNAME e TELNYX_SIP_PASSWORD qui sotto
  5. Crea un Outbound Voice Profile
  6. Acquista numeri DID italiani (+39...)
  7. Associa i DID alla connessione
  
  NOTA TLS:
  Per usare SIP su TLS (porta 5061) invece di UDP (porta 5060):
  - Cambia register-transport da "udp" a "tls"
  - Aggiungi: <param name="register-proxy" value="sip.telnyx.com:5061"/>
  
  PERCORSO DEPLOY:
  /usr/local/freeswitch/etc/freeswitch/sip_profiles/external/telnyx-credentials.xml
  ================================================================
-->

<include>
  <gateway name="telnyx-credentials">
    <!-- Telnyx SIP Proxy: scegli UNO dei due -->
    <!-- Opzione 1: dominio dedicato (richiede Tech Prefix 0312 nel dialplan) -->
    <param name="proxy" value="orbitale.sip.telnyx.com"/>
    <!-- Opzione 2: dominio generico (senza Tech Prefix) -->
    <!-- <param name="proxy" value="sip.telnyx.com"/> -->
    
    <!-- Registrazione attiva: FreeSWITCH si registra con Telnyx -->
    <param name="register" value="true"/>
    
    <!-- Credenziali SIP dal portale Telnyx Mission Control -->
    <!-- SOSTITUISCI con le credenziali reali dal portale -->
    <param name="username" value="TELNYX_SIP_USERNAME"/>
    <param name="password" value="TELNYX_SIP_PASSWORD"/>
    
    <!-- Usa il caller ID originale nel campo From -->
    <param name="caller-id-in-from" value="true"/>
    
    <!-- Registrazione ogni 300 secondi (5 minuti) -->
    <param name="expire-seconds" value="300"/>
    
    <!-- Retry connessione dopo 30 secondi in caso di errore -->
    <param name="retry-seconds" value="30"/>
    
    <!-- Keepalive: invia OPTIONS ogni 25 secondi -->
    <param name="ping" value="25"/>
    
    <!-- Trasporto: UDP (default). Per TLS usa "tls" e porta 5061 -->
    <param name="register-transport" value="udp"/>
    
    <!-- Codec ottimizzati: ordine di preferenza -->
    <param name="codec-prefs" value="PCMU,PCMA,G722,OPUS"/>
    
    <!-- Contesto per le chiamate inbound da questo gateway -->
    <param name="context" value="public"/>
  </gateway>
</include>
