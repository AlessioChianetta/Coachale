<!--
  ================================================================
  Gateway: Messagenet - Autenticazione con Credenziali
  ================================================================
  
  QUANDO USARE QUESTO FILE:
  Questo è il metodo standard per connettersi a Messagenet.
  Messagenet è un provider VoIP italiano che offre numeri geografici
  italiani (fissi) a prezzi competitivi.
  
  SETUP RICHIESTO SU MESSAGENET:
  1. Crea un account su https://www.messagenet.com
  2. Acquista un numero geografico italiano (es. 02-xxx per Milano)
  3. Vai in Area Clienti → Servizi VoIP → Configurazione SIP
  4. Le credenziali SIP sono:
     - Username: URI a 10 cifre che inizia con 5 (es. 5012345678)
     - Password: generata dal sistema
  5. Sostituisci MSGNET_SIP_USERNAME e MSGNET_SIP_PASSWORD qui sotto
  
  NOTA PORTE:
  - Porta primaria: 5061 (NON è TLS, è UDP su porta 5061)
  - Porta fallback: 5060 (se la 5061 non funziona)
  - Se hai problemi, cambia register-proxy a sip.messagenet.it:5060
  
  LIMITAZIONI MESSAGENET:
  - NON supporta TLS/SRTP (la crittografia non è disponibile)
  - NON supporta SIP REFER (trasferimento di chiamata)
  - NON supporta SIP 302 Redirect
  - NON supporta OPUS codec (solo G.711 e G.722)
  - Range IP: 109.233.128.0/21 (da aggiungere all'ACL)
  
  PERCORSO DEPLOY:
  /usr/local/freeswitch/etc/freeswitch/sip_profiles/external/messagenet-credentials.xml
  ================================================================
-->

<include>
  <gateway name="messagenet-credentials">
    <!-- Messagenet SIP Proxy -->
    <param name="proxy" value="sip.messagenet.it"/>
    
    <!-- Registrazione attiva -->
    <param name="register" value="true"/>
    
    <!-- Credenziali SIP da Area Clienti Messagenet -->
    <!-- Username: URI SIP a 10 cifre (inizia con 5xxxxxxxxx) -->
    <!-- SOSTITUISCI con le credenziali reali -->
    <param name="username" value="MSGNET_SIP_USERNAME"/>
    <param name="auth-username" value="MSGNET_SIP_USERNAME"/>
    <param name="password" value="MSGNET_SIP_PASSWORD"/>
    
    <!-- Realm per autenticazione digest -->
    <param name="realm" value="sip.messagenet.it"/>
    
    <!-- Proxy di registrazione: porta 5061 (fallback: 5060) -->
    <!-- Se la registrazione fallisce, prova a cambiare con :5060 -->
    <param name="register-proxy" value="sip.messagenet.it:5061"/>
    
    <!-- Registrazione ogni 300 secondi (5 minuti) -->
    <param name="expire-seconds" value="300"/>
    
    <!-- Retry connessione dopo 30 secondi -->
    <param name="retry-seconds" value="30"/>
    
    <!-- Keepalive: ping ogni 60 secondi -->
    <param name="ping" value="60"/>
    
    <!-- Trasporto: solo UDP (Messagenet NON supporta TLS) -->
    <param name="register-transport" value="udp"/>
    
    <!-- Codec: SOLO G.711 e G.722 (Messagenet NON supporta OPUS) -->
    <param name="codec-prefs" value="PCMU,PCMA,G722"/>
    
    <!-- Contesto per le chiamate inbound da questo gateway -->
    <param name="context" value="public"/>
  </gateway>
</include>
