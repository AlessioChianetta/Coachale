<!--
  ================================================================
  Gateway: Telnyx - Autenticazione IP (IP Authentication)
  ================================================================
  
  QUANDO USARE QUESTO FILE:
  Usa questo gateway quando il tuo VPS ha un IP statico e lo hai
  aggiunto alla whitelist nel portale Telnyx Mission Control.
  Non serve registrazione SIP: Telnyx riconosce il tuo server
  dall'indirizzo IP sorgente.
  
  SETUP RICHIESTO SU TELNYX:
  1. Vai su https://portal.telnyx.com → Networking → SIP Connections
  2. Crea una nuova connessione "IP Authentication"
  3. Aggiungi l'IP pubblico del tuo VPS (72.62.50.40) alla whitelist
  4. Configura il Outbound Voice Profile con i numeri DID acquistati
  5. Associa i DID alla connessione SIP
  
  TECH PREFIX:
  Telnyx richiede il prefisso 0312 davanti al numero di destinazione
  per le chiamate outbound. Il prefisso viene aggiunto nel dialplan
  (02_outbound_trunk.xml), NON nel gateway.
  
  PROXY (scegli UNO):
  - orbitale.sip.telnyx.com → dominio SIP dedicato (con Tech Prefix 0312)
  - sip.telnyx.com → dominio generico Telnyx (senza Tech Prefix)
  Cambia il valore di "proxy" qui sotto in base alla tua configurazione.
  
  PERCORSO DEPLOY:
  /usr/local/freeswitch/etc/freeswitch/sip_profiles/external/telnyx-ip.xml
  
  CODEC:
  PCMU (G.711u), PCMA (G.711a), G722 (HD Voice), OPUS (wideband)
  Telnyx supporta tutti questi codec. OPUS offre la migliore qualità
  con il minor consumo di banda (~32 Kbps vs ~87 Kbps di G.711).
  ================================================================
-->

<include>
  <gateway name="telnyx-ip">
    <!-- Telnyx SIP Proxy: scegli UNO dei due -->
    <!-- Opzione 1: dominio dedicato (richiede Tech Prefix 0312 nel dialplan) -->
    <param name="proxy" value="orbitale.sip.telnyx.com"/>
    <!-- Opzione 2: dominio generico (senza Tech Prefix) -->
    <!-- <param name="proxy" value="sip.telnyx.com"/> -->
    
    <!-- IP Auth: nessuna registrazione necessaria -->
    <param name="register" value="false"/>
    
    <!-- Username e password non servono per IP auth -->
    <param name="username" value="not-used"/>
    <param name="password" value="not-used"/>
    
    <!-- Usa il caller ID originale nel campo From -->
    <param name="caller-id-in-from" value="true"/>
    
    <!-- Codec ottimizzati: ordine di preferenza -->
    <param name="codec-prefs" value="PCMU,PCMA,G722,OPUS"/>
    
    <!-- Keepalive: invia OPTIONS ogni 25 secondi -->
    <param name="ping" value="25"/>
    
    <!-- Retry connessione dopo 30 secondi in caso di errore -->
    <param name="retry-seconds" value="30"/>
    
    <!-- Contesto per le chiamate inbound da questo gateway -->
    <param name="context" value="public"/>
  </gateway>
</include>
