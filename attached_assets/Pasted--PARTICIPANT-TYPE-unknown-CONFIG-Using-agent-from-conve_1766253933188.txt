ğŸ” [PARTICIPANT TYPE] unknown
âœ… [CONFIG] Using agent from conversation: Marco setter (760bb513-098f-4722-b02a-a700160c2fc3)
ğŸ¯ [AGENT TYPE] Agent type: proactive_setter, isProactive: true
âœ… AI is ENABLED and within working hours for consultant 0c73bbe5-51e1-4108-866b-6be7a52fce3b - proceeding with AI response

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ”‘ [STEP 3] Selecting AI Provider (Vertex AI / Google AI Studio)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ†” Conversation ID: 73e9812e-ec3e-4e96-88d6-910c16e7b849
ğŸ‘¤ User Type: LEAD
âœ… [SuperAdmin Gemini] Loaded 1 API keys from config
âœ… Using SuperAdmin Google AI Studio for WhatsApp (Gemini 3)
   ğŸ”‘ Key: 1/1
âœ… Selected AI Provider: studio
   ğŸ” API Key: AIzaSyAzZA...CL20
   ğŸ†” Key ID: superadm...
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ”‘ [API KEY] Extracted from Google AI Studio provider (key: superadm...)
ğŸ’¾ [STEP 4] Saving 1 inbound message(s) to database
âœ… [STEP 4] Saved inbound message b8ebc56f-25d2-4398-84f3-87e766a0c947: "non lo so..."
ğŸ’¬ [AUDIO DETECTION] Client sent text message - No audio TTS needed unless always_audio mode
ğŸ“¸ [STEP 5] Building media context (1 messages)
ğŸ§ª [TEST MODE] Override attivo: lead
ğŸ§ª [TEST MODE] Simulando lead

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ¤– [STEP 6] Building AI System Prompt
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ‘¤ Participant Type: UNKNOWN
ğŸ’¬ Message: "non lo so"

ğŸ” Detecting intent for lead message...
âœ… Intent detected: general

ğŸš¨ Detecting objections in message...
ğŸ”„ [OBJECTION] Attempt 1/3
ğŸ”‘ [OBJECTION] Using current API key: superadm...
ğŸ¤– [OBJECTION] Calling detectObjection() with provider: studio
ğŸ§  [OBJECTION-DETECTOR] Using model: gemini-3-flash-preview with thinking: low
6:03:39 PM [express] GET /api/whatsapp/conversations 200 in 510ms :: {"conversations":[{"id":"73e981â€¦
6:03:41 PM [express] GET /api/whatsapp/conversations/73e9812e-ec3e-4e96-88d6-910c16e7b849/messages 2â€¦
there are non-text parts thoughtSignature in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.
there are non-text parts thoughtSignature in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.
âš ï¸ [OBJECTION] âœ… SUCCESS - Objection detected: trust (confidence: 0.7)
â±ï¸  [TIMING] Objection detection: 3952ms
ğŸ‘¤ Fetching/creating lead profile...
âœ… Lead profile: neutral (difficulty: 5/10)
ğŸ“‹ Fetching recent objections...
âœ… Found 0 recent objection(s)
ğŸ“… [APPOINTMENT CONTEXT] Checking for existing saved slots...
ğŸ’¾ [APPOINTMENT CONTEXT] Retrieved 15 saved slots from database
ğŸ“… [APPOINTMENT CONTEXT] Context maintained - AI can continue appointment flow
âœ… [APPOINTMENT CONTEXT] Final state: 15 slots available for AI prompt
ğŸ” [PROACTIVE CHECK] conversation.isProactiveLead=true, conversation.proactiveLeadId=caec2dc0-10c0-4ec3-aa2c-ee81da8c8689
ğŸ¯ [PROACTIVE LEAD] Found lead data: rosso mio
ğŸ“‹ Lead Info: {"email":"mario.rossi@test.com","fonte":"hubdigital-test","uncino":"abbiamo visto che ti sei iscritto ai nostri contenuti per capire come raggiungere dai 100.000 ai 500.000 nei prossimi 2-4 anni","country":"Italia","desideri":"v","dateAdded":"2025-12-20T01:38:24.044Z","obiettivi":"raggiungere dai 100.000 ai 500.000 di patrimonio nei prossimi 2-4 anni","companyName":"Test SRL","ghlContactId":"contact_test456","ghlLocationId":"loc_test123"}
ğŸ¯ Ideal State: piÃ¹ tranquillitÃ  e la tua libertÃ  finanziaria
ğŸ“ [PROMPT DEBUG] Building prompt with isProactiveAgent=true, isProactiveLead=true
ğŸ“š [KNOWLEDGE BASE] Loaded 1 knowledge items for agent 760bb513-098f-4722-b02a-a700160c2fc3
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ” [TEMPLATE ENGINE] Checking agent instructions...
   agentInstructionsEnabled: false
   agentInstructions length: 0 chars
   selectedTemplate: null
âŒ [TEMPLATE ENGINE] Using LEGACY HARDCODED prompt
   Reason: enabled=false, hasInstructions=false
ğŸ“š [STEP 7] Checking for reset request and fetching message history
ğŸ“š [STEP 7] Found 6 historical messages
ğŸ§  [STEP 8] Calling Gemini AI (model selection based on provider)

ğŸ“Š [GEMINI TOKENS] Stima PRIMA della chiamata:
   ğŸ“ System Prompt: ~10,510 tokens (42,038 chars)
   ğŸ’¬ User Message: ~3 tokens (9 chars)
   ğŸ“œ History: ~360 tokens (1,438 chars)
   ğŸ”¢ TOTALE INPUT: ~10,873 tokens

â„¹ï¸ [FILE SEARCH] No FileSearchStore for this WhatsApp agent
ğŸ”„ [RETRY] Attempt 1/3
   ğŸ§  [AI] Google AI Studio - Using model: gemini-3-flash-preview, thinking: enabled (low)
âœ… [RETRY] Success on attempt 1!
â±ï¸  [TIMING] Gemini API call: 1596ms

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ” [DEBUG] Analyzing Gemini Response Object
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“¦ Response object keys: [
  'sdkHttpResponse',
  'candidates',
  'modelVersion',
  'responseId',
  'usageMetadata'
]
there are non-text parts thoughtSignature in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.
there are non-text parts thoughtSignature in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.
âœ… response.text is a property - using it...
there are non-text parts thoughtSignature in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.
ğŸ“ Extracted text length: 331
ğŸ“ Extracted text preview: Tranquillo, ci sta assolutamente. Spesso sappiamo che qualcosa non va come vorremmo, ma non Ã¨ facile mettere a fuoco il punto esatto. ğŸ˜Š

Per aiutarti a fare chiarezza, di cosa ti occupi esattamente? 
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

there are non-text parts thoughtSignature in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.
there are non-text parts thoughtSignature in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.

ğŸ“Š [GEMINI TOKENS] Utilizzo DOPO la risposta:
   âœ… Response: ~83 tokens (331 chars)
   ğŸ”¢ TOTALE (input + output): ~10,956 tokens
   â±ï¸  Tempo di risposta: 1596ms
   ğŸ’° Costo stimato: $0.021912 (input + output)