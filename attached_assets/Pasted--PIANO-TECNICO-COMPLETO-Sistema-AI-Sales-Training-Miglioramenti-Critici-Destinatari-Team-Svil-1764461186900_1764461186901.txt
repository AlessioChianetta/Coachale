ğŸ“‹ PIANO TECNICO COMPLETO
Sistema AI Sales Training - Miglioramenti Critici
Destinatari: Team Sviluppo
Data: Novembre 2025
Lingua: Italiano

ğŸ—ï¸ ARCHITETTURA ATTUALE DEL SISTEMA
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ARCHITETTURA AI SALES TRAINING                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚              â”‚         â”‚                  â”‚         â”‚              â”‚   â”‚
â”‚   â”‚   SALES      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  SALES MANAGER   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   PROSPECT   â”‚   â”‚
â”‚   â”‚   AGENT      â”‚         â”‚     AGENT        â”‚         â”‚  SIMULATOR   â”‚   â”‚
â”‚   â”‚              â”‚         â”‚  (Supervisore)   â”‚         â”‚              â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â”‚                          â”‚                          â”‚             â”‚
â”‚         â”‚                          â”‚                          â”‚             â”‚
â”‚         â–¼                          â–¼                          â–¼             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚                         WebSocket Layer                           â”‚     â”‚
â”‚   â”‚            (Comunicazione real-time bidirezionale)                â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚                    COMPONENTI BACKEND                             â”‚     â”‚
â”‚   â”‚                                                                    â”‚     â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚     â”‚
â”‚   â”‚  â”‚ Checkpoint      â”‚  â”‚ Step Advancementâ”‚  â”‚ Sales Scripts   â”‚   â”‚     â”‚
â”‚   â”‚  â”‚ Detector        â”‚  â”‚ Agent           â”‚  â”‚ Base            â”‚   â”‚     â”‚
â”‚   â”‚  â”‚ (Keywords)âŒ    â”‚  â”‚ (AI Semantica)  â”‚  â”‚ (B2B/B2C)       â”‚   â”‚     â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚     â”‚
â”‚   â”‚                                                                    â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ“ FILE COINVOLTI NELLE MODIFICHE
File	Percorso	Tipo Modifica
SalesManagerAgent	server/ai/sales-manager-agent.ts	CRITICO - Logica reasoning + checkpoint
StepAdvancementAgent	server/ai/step-advancement-agent.ts	Integrazione per validazione semantica
CheckpointDetector	server/ai/checkpoint-detector.ts	Deprecare keyword matching
Sales Scripts B2B	server/ai/sales-scripts-base.ts	Riscrivere Fasi 3,4,6,7
Sales Scripts B2C	server/ai/sales-scripts-base-B2C.ts	Riscrivere Fasi 3,4,6,7
AITrainerTab	client/src/components/ai-trainer/AITrainerTab.tsx	Frontend - Pannello Thought Process
ProspectSimulator	server/services/prospect-simulator/index.ts	Passare dati Manager al frontend
ğŸ”´ PROBLEMA 1: REASONING NON INCLUSO IN SALES_MANAGER_INSTRUCTION
Situazione Attuale
Il SalesManagerAgent genera reasoning, ma NON sempre lo include nel tag <<<SALES_MANAGER_INSTRUCTION>>>. Il tag viene inviato solo in casi specifici.

Soluzione: SEMPRE includere reasoning quando disponibile
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FLUSSO REASONING â†’ INSTRUCTION                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   PRIMA (Problematico):                                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚   â”‚ Manager genera  â”‚â”€â”€â”€â”€â–ºâ”‚ Solo a volte    â”‚â”€â”€â–º Agente non capisce         â”‚
â”‚   â”‚ reasoning       â”‚     â”‚ invia INSTRUCTIONâ”‚                               â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚                                                                              â”‚
â”‚   DOPO (Corretto):                                                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚   â”‚ Manager genera  â”‚â”€â”€â”€â”€â–ºâ”‚ SE reasoning    â”‚â”€â”€â”€â”€â–ºâ”‚ SEMPRE invia    â”‚       â”‚
â”‚   â”‚ reasoning       â”‚     â”‚ presente        â”‚     â”‚ INSTRUCTION     â”‚       â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Modifica in sales-manager-agent.ts
PRIMA:

// Linea ~450-500: injectManagerInstruction()
private injectManagerInstruction(
  originalMessage: string, 
  analysis: SalesManagerAnalysis
): string {
  // Solo se c'Ã¨ un'istruzione specifica viene inviato il tag
  if (analysis.feedbackForAgent) {
    return `${originalMessage} <<<SALES_MANAGER_INSTRUCTION>>>${analysis.feedbackForAgent}<<</SALES_MANAGER_INSTRUCTION>>>`;
  }
  return originalMessage; // âŒ PROBLEMA: Non invia nulla se non c'Ã¨ feedback esplicito
}

DOPO:

private injectManagerInstruction(
  originalMessage: string, 
  analysis: SalesManagerAnalysis
): string {
  // SEMPRE includere reasoning quando disponibile
  const parts: string[] = [];
  
  // 1. Aggiungi reasoning del Manager (SEMPRE se presente)
  if (analysis.stepAdvancement?.reasoning) {
    parts.push(`[REASONING MANAGER]: ${analysis.stepAdvancement.reasoning}`);
  }
  
  // 2. Aggiungi feedback specifico se presente
  if (analysis.feedbackForAgent) {
    parts.push(`[AZIONE RICHIESTA]: ${analysis.feedbackForAgent}`);
  }
  
  // 3. Aggiungi stato checkpoint se rilevante
  if (analysis.checkpointStatus?.status === 'incomplete') {
    parts.push(`[CHECKPOINT INCOMPLETO]: ${analysis.checkpointStatus.missingItems?.join(', ')}`);
  }
  
  // SE c'Ã¨ qualsiasi contenuto â†’ INVIA SEMPRE il tag
  if (parts.length > 0) {
    const instruction = parts.join('\n');
    return `${originalMessage} <<<SALES_MANAGER_INSTRUCTION>>>\n${instruction}\n<<</SALES_MANAGER_INSTRUCTION>>>`;
  }
  
  return originalMessage;
}

ğŸ”´ PROBLEMA 2: CHECKPOINT USA KEYWORDS INVECE DI AI SEMANTICA
Situazione Attuale
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 SISTEMA CHECKPOINT ATTUALE (PROBLEMATICO)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   Conversazione:                                                             â”‚
â”‚   "Aiuto imprenditori a crescere online con marketing digitale"             â”‚
â”‚                                                                              â”‚
â”‚                    â–¼                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚   â”‚  CheckpointDetector.extractKeywords()                        â”‚           â”‚
â”‚   â”‚                                                              â”‚           â”‚
â”‚   â”‚  Cerca keywords: "chi aiuti", "target", "cliente ideale"     â”‚           â”‚
â”‚   â”‚                                                              â”‚           â”‚
â”‚   â”‚  âŒ NON TROVA le parole esatte                               â”‚           â”‚
â”‚   â”‚  âŒ Il checkpoint risulta INCOMPLETO anche se l'info c'Ã¨!    â”‚           â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Soluzione: Usare AI Semantica (StepAdvancementAgent)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    NUOVO SISTEMA CHECKPOINT (AI SEMANTICA)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   Conversazione:                                                             â”‚
â”‚   "Aiuto imprenditori a crescere online con marketing digitale"             â”‚
â”‚                                                                              â”‚
â”‚                    â–¼                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚   â”‚  StepAdvancementAgent.analyzeCheckpointCompletion()          â”‚           â”‚
â”‚   â”‚                                                              â”‚           â”‚
â”‚   â”‚  Prompt AI: "Il prospect ha spiegato CHI AIUTA? Analizza     â”‚           â”‚
â”‚   â”‚             semanticamente, non cercare parole esatte."       â”‚           â”‚
â”‚   â”‚                                                              â”‚           â”‚
â”‚   â”‚  âœ… AI capisce che "imprenditori" = target identificato      â”‚           â”‚
â”‚   â”‚  âœ… Checkpoint valido!                                       â”‚           â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                              â”‚
â”‚   Output AI:                                                                 â”‚
â”‚   {                                                                          â”‚
â”‚     "isComplete": true,                                                      â”‚
â”‚     "reasoning": "Il prospect ha identificato il suo target come            â”‚
â”‚                   'imprenditori che vogliono crescere online'.              â”‚
â”‚                   L'informazione sul chi aiuta Ã¨ stata raccolta.",          â”‚
â”‚     "evidence": ["imprenditori", "crescere online", "marketing digitale"]   â”‚
â”‚   }                                                                          â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Modifica in sales-manager-agent.ts
File: server/ai/sales-manager-agent.ts
Funzione: validateCheckpoint()

// PRIMA: Usava CheckpointDetector con keywords
private async validateCheckpoint(
  checkpoint: PhaseCheckpoint,
  conversationHistory: Message[]
): Promise<CheckpointValidation> {
  // âŒ Vecchio metodo con keywords
  const detector = new CheckpointDetector();
  return detector.validate(checkpoint, conversationHistory);
}
// DOPO: Usa AI Semantica via StepAdvancementAgent
private async validateCheckpoint(
  checkpoint: PhaseCheckpoint,
  conversationHistory: Message[],
  currentPhase: string
): Promise<CheckpointValidation> {
  // âœ… Nuovo metodo con AI Semantica
  const stepAgent = new StepAdvancementAgent(this.aiClient);
  
  const semanticAnalysis = await stepAgent.analyzeCheckpointCompletion({
    checkpointDescription: checkpoint.description,
    requiredItems: checkpoint.requiredItems,
    conversationContext: conversationHistory.slice(-10), // Ultimi 10 messaggi
    currentPhase: currentPhase
  });
  
  return {
    status: semanticAnalysis.isComplete ? 'complete' : 'incomplete',
    reasoning: semanticAnalysis.reasoning, // â† QUESTO VA NEL TAG INSTRUCTION
    missingItems: semanticAnalysis.missingItems,
    evidence: semanticAnalysis.evidence
  };
}

ğŸ”´ PROBLEMA 3: FASI SCRIPT ERRATE (3, 4, 6, 7)
Mappa Fasi Attuali
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         FASI SCRIPT DISCOVERY                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚   â”‚ FASE 1  â”‚â”€â”€â”€â–ºâ”‚ FASE 2  â”‚â”€â”€â”€â–ºâ”‚ FASE 3  â”‚â”€â”€â”€â–ºâ”‚ FASE 4  â”‚                  â”‚
â”‚   â”‚Apertura â”‚    â”‚Rapport  â”‚    â”‚Info Biz â”‚    â”‚Inquisit.â”‚                  â”‚
â”‚   â”‚   âœ…    â”‚    â”‚Building â”‚    â”‚   ğŸ”´    â”‚    â”‚   ğŸŸ     â”‚                  â”‚
â”‚   â”‚   OK    â”‚    â”‚   âœ…    â”‚    â”‚PROBLEMA â”‚    â”‚MIGLIOR. â”‚                  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                       â”‚              â”‚                       â”‚
â”‚                                       â–¼              â–¼                       â”‚
â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚                              â”‚ L'agente SALTA le domande   â”‚                â”‚
â”‚                              â”‚ obbligatorie e passa avanti â”‚                â”‚
â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚   â”‚ FASE 5  â”‚â”€â”€â”€â–ºâ”‚ FASE 6  â”‚â”€â”€â”€â–ºâ”‚ FASE 7  â”‚                                 â”‚
â”‚   â”‚Soluzioneâ”‚    â”‚Qualific.â”‚    â”‚SerietÃ   â”‚                                 â”‚
â”‚   â”‚   âœ…    â”‚    â”‚   ğŸ”´    â”‚    â”‚   ğŸ”´    â”‚                                 â”‚
â”‚   â”‚   OK    â”‚    â”‚ ERRATA  â”‚    â”‚ ERRATA  â”‚                                 â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚                       â”‚              â”‚                                       â”‚
â”‚                       â–¼              â–¼                                       â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚              â”‚ Logica completamente sbagliata,     â”‚                        â”‚
â”‚              â”‚ da riscrivere da zero               â”‚                        â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

FASE 3 - Info Business/Personali (FIX)
Problema: L'agente non fa TUTTE le domande obbligatorie prima di procedere.

Domande OBBLIGATORIE che devono essere fatte:

Chi aiuti? (Target)
Che modello di business hai?
Qual Ã¨ il tuo ticket medio?
Da quanto tempo fai questo lavoro?
Quanti clienti gestisci al mese?
Modifica in sales-scripts-base.ts e sales-scripts-base-B2C.ts:

// FASE 3 - Checkpoint RIGOROSO
{
  id: "phase_3",
  name: "Raccolta Info Business e Personali",
  checkpoint: {
    description: "TUTTE le informazioni business devono essere raccolte",
    requiredItems: [
      "TARGET_IDENTIFICATO: Chi aiuta il prospect (nicchia/settore)",
      "MODELLO_BUSINESS: Come genera fatturato (servizi/prodotti/consulenza)",
      "TICKET_MEDIO: Range di prezzo dei suoi servizi",
      "ESPERIENZA: Da quanto tempo opera nel settore",
      "VOLUME_CLIENTI: Quanti clienti gestisce (anche approssimativo)"
    ],
    blockingRules: [
      "NON procedere alla Fase 4 se manca QUALSIASI informazione",
      "Se il prospect Ã¨ vago, INSISTERE con domande di approfondimento",
      "Ogni item deve avere una risposta CONCRETA, non generica"
    ]
  },
  questions: [
    "Chi sono i tuoi clienti ideali? A chi ti rivolgi principalmente?",
    "Come funziona il tuo modello di business? Fai servizi, consulenze, prodotti?",
    "Qual Ã¨ il range di prezzo dei tuoi servizi? Ticket medio?",
    "Da quanto tempo fai questo lavoro?",
    "Quanti clienti riesci a gestire in un mese mediamente?"
  ]
}

FASE 6 e 7 - RISCRITTURA COMPLETA
FASE 6 - Qualificazione Budget e Decision Making

{
  id: "phase_6",
  name: "Qualificazione - Budget e Processo Decisionale",
  objective: "Capire se il prospect ha le risorse e l'autoritÃ  per procedere",
  checkpoint: {
    description: "Qualificazione economica e decisionale completata",
    requiredItems: [
      "BUDGET_RANGE: Il prospect ha indicato un range di investimento possibile",
      "DECISION_MAKER: Confermato se decide da solo o con altri",
      "TIMELINE: Quando vorrebbe iniziare/implementare",
      "PRIORITA: Quanto Ã¨ prioritario risolvere questo problema"
    ]
  },
  questions: [
    "Per risolvere questo problema, hai giÃ  un'idea di quanto saresti disposto a investire?",
    "Quando prendi decisioni importanti per il tuo business, decidi tu in autonomia o coinvolgi altre persone?",
    "Se trovassimo la soluzione giusta, quando vorresti iniziare?",
    "Su una scala da 1 a 10, quanto Ã¨ prioritario per te risolvere questo problema adesso?"
  ],
  transitions: {
    onComplete: "phase_7",
    onBudgetTooLow: "gentle_disqualification",
    onNotDecisionMaker: "ask_to_involve_decision_maker"
  }
}

FASE 7 - Costruzione SerietÃ  e Urgenza

{
  id: "phase_7", 
  name: "Costruzione SerietÃ  e Impegno",
  objective: "Creare commitment e verificare la serietÃ  del prospect",
  checkpoint: {
    description: "Il prospect ha dimostrato serietÃ  e impegno",
    requiredItems: [
      "IMPEGNO_VERBALE: Il prospect ha espresso volontÃ  di procedere",
      "PROBLEMA_PRIORITARIO: Ha confermato che vuole risolverlo",
      "APERTURA_SOLUZIONE: Ãˆ aperto a valutare la nostra proposta"
    ]
  },
  questions: [
    "Se ti mostrassi esattamente come possiamo risolvere [PROBLEMA], saresti pronto a valutare seriamente la proposta?",
    "Cosa ti impedirebbe di iniziare se la soluzione fosse quella giusta?",
    "Su una scala da 1 a 10, quanto sei motivato a cambiare questa situazione?"
  ],
  closingStatement: "Perfetto [NOME], mi sembra che tu sia una persona seria che vuole davvero risultati. Ti propongo di passare alla fase successiva dove ti mostro esattamente come lavoriamo."
}

ğŸ”´ PROBLEMA 4: VINCOLO PAGAMENTI IN DISCOVERY
Regola Business
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    REGOLA PAGAMENTI DISCOVERY vs DEMO                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   IN DISCOVERY:                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚   â”‚  âŒ NON si parla di prezzi specifici                        â”‚           â”‚
â”‚   â”‚  âŒ NON si parla di modalitÃ  di pagamento                   â”‚           â”‚
â”‚   â”‚  âŒ NON si chiude la vendita                                â”‚           â”‚
â”‚   â”‚                                                              â”‚           â”‚
â”‚   â”‚  âœ… SI puÃ² dire "Abbiamo diverse opzioni di investimento"   â”‚           â”‚
â”‚   â”‚  âœ… SI puÃ² qualificare il budget del prospect               â”‚           â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                              â”‚
â”‚   SE IL PROSPECT CHIEDE "QUANTO COSTA?" IN DISCOVERY:                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚   â”‚  Risposta: "Ottima domanda! I nostri percorsi variano in    â”‚           â”‚
â”‚   â”‚  base alle esigenze specifiche. Prima di parlare di         â”‚           â”‚
â”‚   â”‚  investimento, voglio capire bene la tua situazione per     â”‚           â”‚
â”‚   â”‚  poterti consigliare la soluzione piÃ¹ adatta. Dimmi..."     â”‚           â”‚
â”‚   â”‚                                                              â”‚           â”‚
â”‚   â”‚  â†’ RIPORTA alla fase corrente dello script                  â”‚           â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                              â”‚
â”‚   IN DEMO:                                                                   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚   â”‚  âœ… SI parla di prezzi specifici                            â”‚           â”‚
â”‚   â”‚  âœ… SI parla di modalitÃ  di pagamento                       â”‚           â”‚
â”‚   â”‚  âœ… SI puÃ² chiudere la vendita                              â”‚           â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Implementazione in sales-manager-agent.ts
// Aggiungere in SalesManagerAgent.analyzeMessage()
private checkPaymentDiscussionBlock(
  message: string,
  currentScript: 'discovery' | 'demo',
  currentPhase: string,
  completedPhases: string[]
): PaymentBlockResult {
  
  const paymentPatterns = [
    /quanto costa/i,
    /prezzo/i,
    /pagamento/i,
    /rate/i,
    /investimento.*quanto/i,
    /posso pagare/i
  ];
  
  const isPaymentQuestion = paymentPatterns.some(p => p.test(message));
  
  if (isPaymentQuestion && currentScript === 'discovery') {
    // Verifica se tutte le fasi propedeutiche sono complete
    const requiredPhases = ['phase_1', 'phase_2', 'phase_3', 'phase_4', 'phase_5', 'phase_6', 'phase_7'];
    const allPhasesComplete = requiredPhases.every(p => completedPhases.includes(p));
    
    if (!allPhasesComplete) {
      return {
        blocked: true,
        reasoning: `Il prospect ha chiesto del prezzo ma siamo in Discovery fase ${currentPhase}. 
                    Fasi mancanti: ${requiredPhases.filter(p => !completedPhases.includes(p)).join(', ')}.
                    AZIONE: Deflettere gentilmente e tornare alla fase corrente.`,
        suggestedResponse: "Ottima domanda! I nostri percorsi variano in base alle esigenze. " +
                          "Prima voglio capire meglio la tua situazione per consigliarti la soluzione piÃ¹ adatta. " +
                          "Tornando a quello che mi stavi dicendo..."
      };
    }
  }
  
  return { blocked: false };
}

ğŸ”´ PROBLEMA 5: FRONTEND - THOUGHT PROCESS DEL MANAGER
UI Mockup Testuale
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         MODALE "OSSERVA CONVERSAZIONE"                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚      TRANSCRIPT (Esistente)     â”‚  â”‚   THOUGHT PROCESS MANAGER ğŸ§     â”‚   â”‚
â”‚  â”‚                                 â”‚  â”‚         (NUOVO PANNELLO)         â”‚   â”‚
â”‚  â”‚  ğŸ¤– Agent: Ciao! Come posso    â”‚  â”‚                                  â”‚   â”‚
â”‚  â”‚     aiutarti oggi?             â”‚  â”‚  ğŸ“ FASE ATTUALE: 3/7            â”‚   â”‚
â”‚  â”‚                                 â”‚  â”‚     Info Business/Personali      â”‚   â”‚
â”‚  â”‚  ğŸ‘¤ Prospect: Voglio crescere  â”‚  â”‚                                  â”‚   â”‚
â”‚  â”‚     il mio business            â”‚  â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”   â”‚   â”‚
â”‚  â”‚                                 â”‚  â”‚                                  â”‚   â”‚
â”‚  â”‚  ğŸ¤– Agent: Fantastico! Che     â”‚  â”‚  ğŸ¯ CHECKPOINT STATUS            â”‚   â”‚
â”‚  â”‚     tipo di business hai?      â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚   â”‚
â”‚  â”‚                                 â”‚  â”‚  â”‚ âœ… Target identificato  â”‚     â”‚   â”‚
â”‚  â”‚  ğŸ‘¤ Prospect: Faccio coaching  â”‚  â”‚  â”‚ âŒ Modello business     â”‚     â”‚   â”‚
â”‚  â”‚     per imprenditori           â”‚  â”‚  â”‚ âŒ Ticket medio         â”‚     â”‚   â”‚
â”‚  â”‚                                 â”‚  â”‚  â”‚ âŒ Esperienza           â”‚     â”‚   â”‚
â”‚  â”‚  ğŸ¤– Agent: Perfetto! E qual Ã¨  â”‚  â”‚  â”‚ âŒ Volume clienti       â”‚     â”‚   â”‚
â”‚  â”‚     il tuo ticket medio?       â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚   â”‚
â”‚  â”‚                                 â”‚  â”‚                                  â”‚   â”‚
â”‚  â”‚                                 â”‚  â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”   â”‚   â”‚
â”‚  â”‚                                 â”‚  â”‚                                  â”‚   â”‚
â”‚  â”‚                                 â”‚  â”‚  ğŸ’­ REASONING MANAGER            â”‚   â”‚
â”‚  â”‚                                 â”‚  â”‚  "Il prospect ha identificato    â”‚   â”‚
â”‚  â”‚                                 â”‚  â”‚   il suo target (imprenditori)   â”‚   â”‚
â”‚  â”‚                                 â”‚  â”‚   ma non ha ancora specificato   â”‚   â”‚
â”‚  â”‚                                 â”‚  â”‚   il modello di business nÃ© il   â”‚   â”‚
â”‚  â”‚                                 â”‚  â”‚   ticket medio. L'agente sta     â”‚   â”‚
â”‚  â”‚                                 â”‚  â”‚   procedendo correttamente       â”‚   â”‚
â”‚  â”‚                                 â”‚  â”‚   chiedendo il ticket medio."    â”‚   â”‚
â”‚  â”‚                                 â”‚  â”‚                                  â”‚   â”‚
â”‚  â”‚                                 â”‚  â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”   â”‚   â”‚
â”‚  â”‚                                 â”‚  â”‚                                  â”‚   â”‚
â”‚  â”‚                                 â”‚  â”‚  ğŸ“¤ ULTIMO FEEDBACK INVIATO     â”‚   â”‚
â”‚  â”‚                                 â”‚  â”‚  "Continua a raccogliere info    â”‚   â”‚
â”‚  â”‚                                 â”‚  â”‚   sul business prima di          â”‚   â”‚
â”‚  â”‚                                 â”‚  â”‚   procedere alla fase 4."        â”‚   â”‚
â”‚  â”‚                                 â”‚  â”‚                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Implementazione Frontend
File: client/src/components/ai-trainer/AITrainerTab.tsx

1. Aggiungere interfaccia per dati Manager:

interface ManagerThoughtProcess {
  currentPhase: {
    number: number;
    name: string;
    totalPhases: number;
  };
  checkpointStatus: {
    items: Array<{
      name: string;
      completed: boolean;
      evidence?: string;
    }>;
    overallComplete: boolean;
  };
  reasoning: string;
  lastFeedbackSent: string;
  lastUpdated: string;
}

2. Aggiungere query per dati Manager:

const { data: managerThoughts } = useQuery<ManagerThoughtProcess>({
  queryKey: [`/api/ai-trainer/session/${observeSessionId}/manager-thoughts`],
  queryFn: async () => {
    if (!observeSessionId) return null;
    const response = await fetch(
      `/api/ai-trainer/session/${observeSessionId}/manager-thoughts`,
      { headers: getAuthHeaders() }
    );
    if (!response.ok) return null;
    return response.json();
  },
  enabled: !!observeSessionId,
  refetchInterval: 2000, // Aggiorna ogni 2 secondi
});

3. Aggiungere componente pannello Thought Process:

function ManagerThoughtPanel({ thoughts }: { thoughts: ManagerThoughtProcess }) {
  return (
    <Card className="bg-purple-50 dark:bg-purple-950 border-purple-200">
      <CardHeader>
        <CardTitle className="flex items-center gap-2 text-lg">
          <Brain className="h-5 w-5 text-purple-600" />
          Thought Process del Manager
        </CardTitle>
      </CardHeader>
      <CardContent className="space-y-4">
        {/* Fase Attuale */}
        <div className="flex items-center justify-between">
          <span className="text-sm text-gray-600">Fase Attuale:</span>
          <Badge className="bg-purple-600">
            {thoughts.currentPhase.number}/{thoughts.currentPhase.totalPhases} - {thoughts.currentPhase.name}
          </Badge>
        </div>
        
        {/* Checkpoint Status */}
        <div className="space-y-2">
          <h4 className="text-sm font-semibold">Checkpoint Status:</h4>
          <div className="space-y-1">
            {thoughts.checkpointStatus.items.map((item, i) => (
              <div key={i} className="flex items-center gap-2 text-sm">
                {item.completed ? (
                  <CheckCircle className="h-4 w-4 text-green-500" />
                ) : (
                  <XCircle className="h-4 w-4 text-red-500" />
                )}
                <span>{item.name}</span>
              </div>
            ))}
          </div>
        </div>
        
        {/* Reasoning */}
        <div className="space-y-2">
          <h4 className="text-sm font-semibold flex items-center gap-2">
            <MessageSquare className="h-4 w-4" />
            Reasoning:
          </h4>
          <p className="text-sm text-gray-600 bg-white dark:bg-gray-800 p-3 rounded-lg">
            {thoughts.reasoning}
          </p>
        </div>
        
        {/* Ultimo Feedback */}
        {thoughts.lastFeedbackSent && (
          <div className="space-y-2">
            <h4 className="text-sm font-semibold">Ultimo Feedback Inviato:</h4>
            <p className="text-sm italic text-purple-700 dark:text-purple-300">
              "{thoughts.lastFeedbackSent}"
            </p>
          </div>
        )}
      </CardContent>
    </Card>
  );
}

ğŸ“Š RIEPILOGO MODIFICHE
#	Modifica	File	PrioritÃ 
1	SEMPRE includere reasoning in SALES_MANAGER_INSTRUCTION	sales-manager-agent.ts	ğŸ”´ CRITICA
2	Checkpoint con AI Semantica invece di Keywords	sales-manager-agent.ts + step-advancement-agent.ts	ğŸ”´ CRITICA
3	Fix Fase 3 - Forzare domande obbligatorie	sales-scripts-base.ts + sales-scripts-base-B2C.ts	ğŸ”´ CRITICA
4	Riscrivere Fase 6 (Qualificazione)	sales-scripts-base.ts + sales-scripts-base-B2C.ts	ğŸ”´ CRITICA
5	Riscrivere Fase 7 (SerietÃ )	sales-scripts-base.ts + sales-scripts-base-B2C.ts	ğŸ”´ CRITICA
6	Migliorare Fase 4 (Inquisitoria)	sales-scripts-base.ts + sales-scripts-base-B2C.ts	ğŸŸ  ALTA
7	Vincolo Pagamenti Discovery/Demo	sales-manager-agent.ts	ğŸŸ  ALTA
8	Frontend Pannello Thought Process	AITrainerTab.tsx	ğŸŸ  ALTA
9	API Backend per dati Manager	Nuovo endpoint	ğŸŸ  ALTA
10	Test completo del sistema	-	ğŸŸ¢ NORMALE
