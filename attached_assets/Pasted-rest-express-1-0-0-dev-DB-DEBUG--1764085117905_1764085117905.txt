rest-express@1.0.0 dev
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ” [DB DEBUG] DATABASE_URL caricato dal .env:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   URL (password masked): postgresql:***MASKED***@helium/heliumdb?sslmode=disable
   Lunghezza URL: 62 caratteri
   Contiene "supabase.com"? false
   Contiene "pooler"? false
   Porta utilizzata: non trovata
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ”§ [DB CONFIG] Configurazione rilevata:
   isSupabase: false
   hasQueryParams: true
ğŸ”Œ Database connection: PostgreSQL standard
ğŸ”§ [DB CONFIG] Connection string finale (masked): postgresql:***MASKED***@helium/heliumdb?sslmode=disable
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ” [ENV DEBUG] File .env caricato. Variabili chiave:
   DATABASE_URL definito? true
   ENCRYPTION_KEY definito? true
   SESSION_SECRET definito? true
   NODE_ENV: development
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ… All required environment variables are set
âœ… Encryption tests passed (legacy + per-consultant)
âœ… Encryption configuration verified successfully (per-consultant system active)
ğŸ”§ Setting up Gemini Live WebSocket server...
ğŸ”§ WebSocketServer instance created, attaching connection handler...
âœ… Gemini Live API WebSocket server setup on /ws/ai-voice
3:38:21 PM [express] ğŸ“§ [PID:144 | RegID:cfxiid] Email scheduler enabled - ensuring cron job with schedule: 0 * * * *
âœ… [SCHEDULER REGISTRY] Registering new scheduler (ID: cfxiid)
ğŸ“§ [SCHEDULER REGISTRY] Email scheduler active with schedule: 0 * * * *
3:38:21 PM [express] âœ… [PID:144 | RegID:cfxiid] Email scheduler registration completed
3:38:21 PM [express] ğŸ“± WhatsApp polling service enabled - starting polling...
âœ… [WHATSAPP POLLING] Starting polling service (ID: whatsapp-polling-1764085101425)
ğŸ“… [WHATSAPP POLLING] Schedule: every 90 seconds
ğŸ”„ [WHATSAPP POLLING] Starting poll cycle...
3:38:21 PM [express] âœ… WhatsApp polling service started
3:38:21 PM [express] ğŸ§¹ Starting ghost conversation cleanup service...
ğŸ§¹ [CLEANUP] Starting ghost conversation cleanup (every 5 minutes)
3:38:21 PM [express] âœ… Ghost conversation cleanup service started
3:38:21 PM [express] ğŸ“… Google Calendar sync service enabled - starting sync...
âœ… [CALENDAR SYNC] Starting calendar sync service (ID: calendar-sync-1764085101432)
ğŸ“… [CALENDAR SYNC] Schedule: every 5 minute(s)
3:38:21 PM [express] âœ… Google Calendar sync service started
3:38:21 PM [express] ğŸ“¤ Proactive outreach scheduler enabled - starting scheduler...
ğŸš€ Starting proactive outreach scheduler (every 5 minutes)
âœ… Proactive outreach scheduler started successfully (checking every 5 minutes)
3:38:21 PM [express] âœ… Proactive outreach scheduler started
3:38:21 PM [express] ğŸ“¥ Lead polling scheduler enabled - initializing...
ğŸ”„ Initializing lead polling scheduler...
3:38:21 PM [express] serving on port 5000
âŒ [CLEANUP] Error cleaning up ghost conversations: error: relation "whatsapp_conversations" does not exist
    at /home/runner/workspace/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/node_modules/src/node-postgres/session.ts:104:19)
    at async cleanupGhostConversations (/home/runner/workspace/server/whatsapp/cleanup-ghost-conversations.ts:23:29) {
  length: 121,
  severity: 'ERROR',
  code: '42P01',
  detail: undefined,
  hint: undefined,
  position: '48',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_relation.c',
  line: '1452',
  routine: 'parserOpenTable'
}
Error fetching all polling configs: error: relation "users" does not exist
    at /home/runner/workspace/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/node_modules/src/node-postgres/session.ts:104:19)
    at async LeadPollingScheduler.getAllPollingConfigs (/home/runner/workspace/server/services/lead-polling-scheduler.ts:209:27)
    at async LeadPollingScheduler.initialize (/home/runner/workspace/server/services/lead-polling-scheduler.ts:20:26)
    at async <anonymous> (/home/runner/workspace/server/index.ts:274:7) {
  length: 105,
  severity: 'ERROR',
  code: '42P01',
  detail: undefined,
  hint: undefined,
  position: '267',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_relation.c',
  line: '1452',
  routine: 'parserOpenTable'
}
ğŸ“‹ Found 0 total configs across all consultants
âœ… Found 0 configs with polling enabled and active
âœ… Lead polling scheduler initialized successfully
3:38:23 PM [express] âœ… Lead polling scheduler initialized
3:38:23 PM [express] ğŸ“Š Training summary aggregator enabled - starting scheduler...
âœ… [TRAINING AGGREGATOR] Registering cron job (ID: nfedwt)
ğŸ“… [TRAINING AGGREGATOR] Schedule: Daily at 3:00 AM
â° [TRAINING AGGREGATOR] Timezone: UTC
âœ… [TRAINING AGGREGATOR] Cron job started successfully
3:38:23 PM [express] âœ… Training summary aggregator started
âŒ [WHATSAPP POLLING] Error in poll cycle: error: relation "consultant_whatsapp_config" does not exist
    at /home/runner/workspace/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/node_modules/src/node-postgres/session.ts:104:19)
    at async pollAllConsultants (/home/runner/workspace/server/whatsapp/polling-service.ts:333:17) {
  length: 127,
  severity: 'ERROR',
  code: '42P01',
  detail: undefined,
  hint: undefined,
  position: '1190',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_relation.c',
  line: '1452',
  routine: 'parserOpenTable'
}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ”„ [CALENDAR SYNC] Starting sync cycle...
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âŒ [CALENDAR SYNC] Error in sync cycle: error: relation "consultant_availability_settings" does not exist
    at /home/runner/workspace/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/node_modules/src/node-postgres/session.ts:104:19)
    at async syncAllConsultants (/home/runner/workspace/server/services/calendar-sync-service.ts:208:24) {
  length: 131,
  severity: 'ERROR',
  code: '42P01',
  detail: undefined,
  hint: undefined,
  position: '29',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_relation.c',
  line: '1452',
  routine: 'parserOpenTable'