INTENT-ROUTER] Classification result: intent=analytics, requires_metrics=true, confidence=0.98, tools=[execute_metric]
[QUERY-PLANNER] Router result: intent=analytics, requires_metrics=true, confidence=0.98
[POLICY-ENGINE] Getting policy for intent: analytics
[QUERY-PLANNER] Policy: allowedTools=[execute_metric,query_metric,aggregate_group,compare_periods,filter_data,get_schema], requireToolCall=true
[SEMANTIC-ORDERBY] Detected "fatturato" ‚Üí metric="revenue", direction=DESC
[QUERY-PLANNER] SEMANTIC ORDERBY DETECTED: metric="revenue", direction=DESC
üîç Finding AI provider for client 0c73bbe5-51e1-4108-866b-6be7a52fce3b (consultant: 0c73bbe5-51e1-4108-866b-6be7a52fce3b)...
üìã Client preferred AI provider: vertex_admin
üîç TIER 0: Checking SuperAdmin Gemini Keys (Google AI Studio)...
‚úÖ TIER 0: Using SuperAdmin Google AI Studio (Gemini 3)
   üîë Key: 1/1
[QUERY-PLANNER] Conversation context for planner: 0 messages
[QUERY-PLANNER] Allowed tools for AI: [execute_metric, query_metric, compare_periods, filter_data, aggregate_group, get_schema]
[QUERY-PLANNER] Using Router Agent classification (legacy classifier disabled)
üîí [Semaphore] Acquired slot (1/3 in use)
üîå [GEMINI TRACKER] ACTIVE GEMINI STREAMS: 0
üîì [Semaphore] Released slot (0/3 in use)
there are non-text parts functionCall in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.
[QUERY-PLANNER] Plan: 1 steps, complexity: simple
[POLICY-ENGINE] Enforcing policy for intent: analytics, tool calls: 1
[POLICY-ENGINE] ALLOWED: execute_metric
[POLICY-ENGINE] Result: allowed=1, blocked=0, violations=0
[POLICY-ENGINE] Tool analysis: hasComputeTool=true, hasOnlyMetadata=false
[POLICY-ENGINE] VALIDATION OK: compute tool present
[EXECUTE-METRIC] Called with metricName: "revenue", datasetId: 21
[REVENUE-TRACKING] Dataset 21 - Using revenue_amount: "revenue_amount" for revenue
[EXECUTE-METRIC] Resolved SQL: SUM(CAST("revenue_amount" AS NUMERIC))
[QUERY-RULES] Detected ORDER BY keyword: "fatturato" ‚Üí revenue DESC
[QUERY-RULES] Rule 6: Applying ORDER BY revenue_amount DESC
[EXECUTE-METRIC] Query rules applied: RULE_6_ORDER_BY_SEMANTIC
[EXECUTE-METRIC] Enhancements: WHERE=none, ORDER BY="revenue_amount" DESC
[QUERY-EXECUTOR] Query execution error: invalid input syntax for type numeric: "199,5"
[EXECUTE-METRIC] Result: success=false, error=invalid input syntax for type numeric: "199,5"
[QUERY-PLANNER] Tool execute_metric failed: invalid input syntax for type numeric: "199,5"
[QUERY-PLANNER] Execution complete in 1425ms, success: false
üîç Finding AI provider for client 0c73bbe5-51e1-4108-866b-6be7a52fce3b (consultant: 0c73bbe5-51e1-4108-866b-6be7a52fce3b)...
üìã Client preferred AI provider: vertex_admin