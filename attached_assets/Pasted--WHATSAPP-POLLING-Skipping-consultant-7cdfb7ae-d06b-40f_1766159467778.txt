âš ï¸ [WHATSAPP POLLING] Skipping consultant 7cdfb7ae-d06b-40f6-9840-91f72772a390 - incomplete config
ğŸ” [FileSearch] Including client's private store for user 7e40b56c-2cc8-4515-b843-dc105e478f38
ğŸ” [FileSearch] getStoreNamesForGeneration - Role: client, UserId: 7e40b56c-2cc8-4515-b843-dc105e478f38, ConsultantId: 0c73bbe5-51e1-4108-866b-6be7a52fce3b
   ğŸ“¦ Found 2 unique stores: Private Store - Client 7e40b56c, Knowledge Base Consulente

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ” FILE SEARCH MODE: Switching to Google AI Studio (required for File Search)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ğŸ“¦ Provider: Google AI Studio (@google/genai)
   âœ… File Search API: SUPPORTED
   âš ï¸  Vertex AI: NOT compatible with File Search
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… Using GEMINI_API_KEY from environment for File Search
ğŸ”„ Building context for client 7e40b56c-2cc8-4515-b843-dc105e478f38 (intent: university, sessionType: normal)
ğŸ”– [WATERMARK] Agent Marco setter (760bb513-098f-4722-b02a-a700160c2fc3) - last processed: 2025-12-14T18:11:36.000Z
âœ… [WHATSAPP POLLING] No new messages for agent Marco setter
ğŸ“Œ [WATERMARK] Latest on Twilio (2025-12-14T18:11:36.000Z) is older than watermark - keeping current
ğŸ“š Including ALL 0 exercises in context (no limits applied)
ğŸ“š Prepared 0 exercise metadata (content will be loaded on-demand when asked)
ğŸ”– [WATERMARK] Agent Receptionist Principale (fe95f393-b8c9-4fc0-80d7-2035dcba305a) - last processed: 2025-12-14T18:11:36.000Z
âœ… [WHATSAPP POLLING] No new messages for agent Receptionist Principale
ğŸ“š Found 0 documents linked to exercises
âœ… [WHATSAPP POLLING] Poll cycle complete
ğŸ“š Total library documents included in context: 5 (intent: university)
ğŸ“Š Momentum stats: 14 check-ins (14 productive, 100% rate), streak: 0 days
ğŸ“… Calendar stats: 0 total upcoming (0 ongoing, 0 today, 0 this week)
ğŸ“š [Knowledge Base] Loading ALL knowledge content for client (no filtering)...
ğŸ“š [Client Knowledge Base] Loaded 0 documents and 0 APIs for client 7e40b56c-2cc8-4515-b843-dc105e478f38
â„¹ï¸ [Knowledge Base] No documents or API data uploaded yet
ğŸ’¾ Stored fresh context in cache for client 7e40b56c-2cc8-4515-b843-dc105e478f38 (intent: university)
â±ï¸  [TIMING] Context building: 2287ms
â±ï¸  [TIMING] Exercise scraping: 0ms
â±ï¸  [TIMING] Prompt building: 22ms

ğŸ“Š Token Usage Estimation (Intent: university):
  - System Prompt: ~27,033 tokens
  - User Message: ~7 tokens
  - Conversation History: ~0 tokens
  - Total Estimated: ~27,040 tokens
  - File Search Mode: âœ… ACTIVE (RAG via stores)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“Š SYSTEM PROMPT BREAKDOWN (~27,033 tokens)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ NEL SYSTEM PROMPT (27,033 tokens):
   ğŸ’° Finance Data: 0 tokens
   ğŸ¯ Goals & Tasks: 12 tokens
   âš¡ Momentum & Calendar: 17 tokens
   ğŸ—ºï¸  Roadmap: 2,458 tokens
   ğŸ‘¤ User Profile & Base: 5,055 tokens
   ğŸ“ University: 10,102 tokens

ğŸ” VIA FILE SEARCH RAG (non nel prompt, cercati su richiesta):
   ğŸ“š Exercises: 3 tokens â†’ via RAG
   ğŸ“– Library Docs: 1,573 tokens â†’ via RAG
   ğŸ’¬ Consultations: 41,700 tokens â†’ via RAG
   ğŸ“š Knowledge Base: 41 tokens â†’ via RAG

   ğŸ’° RISPARMIO: ~43,317 tokens spostati su File Search

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ” AI MODE: FILE SEARCH SEMANTIC (Gemini RAG) [CLIENT]
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ğŸ“¦ Stores disponibili: 2
      1. fileSearchStores/private-store-client-7e40b5-g2rbtd1xrc4n
      2. fileSearchStores/knowledge-base-consulente-juw371zchi3s
   âœ… Tool fileSearch: ATTIVO
   ğŸ“„ Il modello cercherÃ  semanticamente nei documenti indicizzati
   ğŸ’° RISPARMIO TOKENS: ~43,317 tokens (esercizi+library+consultazioni+KB)
   ğŸ“‰ System prompt ridotto: da ~70,350 a ~27,033 tokens
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ”„ AI stream attempt 1/6...
âœ… AI streaming completed successfully on attempt 1
â±ï¸  [TIMING] Gemini API call (with streaming): 4540ms
âœ… AI streaming completed for message 6a43eb16-e3e4-4a54-93a6-ce7fde5777e3

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ” FILE SEARCH STREAMING SUMMARY [CLIENT]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   ğŸ“¦ Stores attivi: 2
   âš ï¸  Nota: In modalitÃ  streaming, le citazioni non sono disponibili
      nel response object. File Search Ã¨ stato configurato come tool.
   ğŸ“„ Se la risposta cita documenti specifici, Gemini ha usato File Search.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€


â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
â±ï¸  PERFORMANCE TIMING BREAKDOWN
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   [0ms â†’ 2287ms] Context Building (2287ms)
   [2287ms â†’ 2287ms] Exercise Scraping (0ms)
   [2287ms â†’ 2309ms] Prompt Building (22ms)
   [2309ms â†’ 7995ms] Gemini API Call (4540ms)
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   â±ï¸  TOTAL: 8.00s (7995ms)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

3:49:41 PM [express] POST /api/ai/chat 200 in 8198ms
3:49:42 PM [express] GET /api/ai/conversations 200 in 404ms :: [{"id":"9370a049-6879-4496-8842-f014dâ€¦
3:49:42 PM [express] GET /api/ai/conversations/9370a049-6879-4496-8842-f014dcc8524a 200 in 803ms :: â€¦

ğŸš€ [PROACTIVE OUTREACH] Starting scheduled run at 2025-12-19T15:50:00.022Z
â° [FOLLOWUP-SCHEDULER] HOT/WARM evaluation cycle triggered
ğŸ” [FOLLOWUP-SCHEDULER] Starting HOT/WARM follow-up evaluation cycle...
â° [FOLLOWUP-SCHEDULER] Processing cycle triggered
ğŸ“¤ [FOLLOWUP-SCHEDULER] Processing scheduled messages...
ğŸ”„ [WHATSAPP POLLING] Starting poll cycle...

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ”„ [CALENDAR SYNC] Starting sync cycle...