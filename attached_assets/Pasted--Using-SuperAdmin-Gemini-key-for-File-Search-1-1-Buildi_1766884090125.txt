‚úÖ Using SuperAdmin Gemini key for File Search (1/1)
üîÑ Building context for client 19ed2469-e094-4033-9198-156fc5dbfd3f (intent: general, sessionType: normal)
üìö Including ALL 0 exercises in context (no limits applied)
üìö Prepared 0 exercise metadata (content will be loaded on-demand when asked)
üìö Found 0 documents linked to exercises
üìö Total library documents included in context: 0 (intent: general)
üìä Momentum stats: 0 check-ins (0 productive, 0% rate), streak: 0 days
üìÖ Calendar stats: 0 total upcoming (0 ongoing, 0 today, 0 this week)
üìö [Knowledge Base] Loading ALL knowledge content for client (no filtering)...
üìö [Client Knowledge Base] Loaded 4 documents and 0 APIs for client 19ed2469-e094-4033-9198-156fc5dbfd3f
‚úÖ [Knowledge Base] Loaded ALL content: 4 documents, 0 API sources
üíæ Stored fresh context in cache for client 19ed2469-e094-4033-9198-156fc5dbfd3f (intent: general)
‚è±Ô∏è  [TIMING] Context building: 2040ms
‚è±Ô∏è  [TIMING] Exercise scraping: 1ms
‚è±Ô∏è  [TIMING] Prompt building: 95ms

üìä Token Usage Estimation (Intent: general):
  - System Prompt: ~2,397,140 tokens
  - User Message: ~13 tokens
  - Conversation History: ~0 tokens
  - Total Estimated: ~2,397,153 tokens
  - File Search Mode: ‚úÖ ACTIVE (RAG via stores)

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
üìä SYSTEM PROMPT BREAKDOWN (~2,397,140 tokens)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

üìç NEL SYSTEM PROMPT (2,397,140 tokens):
   üë§ User Profile & Base: ~2,397,140 tokens
   ‚ÑπÔ∏è  (Include: data/ora, profilo utente, istruzioni AI, metadata esercizi)

üîç VIA FILE SEARCH RAG (indicizzati, cercati su richiesta):
   üß† Knowledge Base: 2,395,706 tokens (264 documenti)

   üí∞ TOTALE FILE SEARCH: 2,395,706 tokens (264 documenti indicizzati)

‚ö†Ô∏è  NON DISPONIBILI ALL'AI (non sincronizzati in File Search):
   üìö Exercises: ~500 tokens (1 documenti)
   üìñ Library: ~1,000 tokens (1 documenti)
   üí¨ Consultations: ~300 tokens (1 documenti)
   üéì University: ~800 tokens (1 documenti)
   üí° TIP: Sincronizza questi documenti in File Search per renderli disponibili all'AI

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê


‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
üîç AI MODE: FILE SEARCH SEMANTIC (Gemini RAG) [CLIENT]
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   üì¶ Stores disponibili: 1
      1. fileSearchStores/private-store-client-19ed24-7vc3z6n39pxe

   üìä BREAKDOWN DOCUMENTI PER STORE:

   üë• Private Store - Client 19ed2469 (264 documenti):
      üß† Knowledge Base: 264
   ‚úÖ Tool fileSearch: ATTIVO
   üìÑ Il modello cercher√† semanticamente nei documenti indicizzati
   üí∞ RISPARMIO TOKENS: ~2,410,774 tokens (esercizi+library+consultazioni+KB)
   üìâ System prompt ridotto: da ~4,807,914 a ~2,397,140 tokens
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

[AI] Using model: gemini-3-flash-preview with thinking_level: low [CLIENT STREAMING]
[AI] Provider: Google AI Studio -> Gemini 3 Flash
üîÑ AI stream attempt 1/6...
‚ùå AI streaming error on attempt 1: {"error":{"message":"{\n  \"error\": {\n    \"code\": 429,\n    \"message\": \"You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/usage?tab=rate-limit. \\n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_paid_tier_input_token_count, limit: 1000000, model: gemini-3-flash\\nPlease retry in 3.785123752s.\",\n    \"status\": \"RESOURCE_EXHAUSTED\",\n    \"details\": [\n      {\n        \"@type\": \"type.googleapis.com/google.rpc.Help\",\n        \"links\": [\n          {\n            \"description\": \"Learn more about Gemini API quotas\",\n            \"url\": \"https://ai.google.dev/gemini-api/docs/rate-limits\"\n          }\n        ]\n      },\n      {\n        \"@type\": \"type.googleapis.com/google.rpc.QuotaFailure\",\n        \"violations\": [\n          {\n            \"quotaMetric\": \"generativelanguage.googleapis.com/generate_content_paid_tier_input_token_count\",\n            \"quotaId\": \"GenerateContentPaidTierInputTokensPerModelPerMinute\",\n            \"quotaDimensions\": {\n              \"model\": \"gemini-3-flash\",\n              \"location\": \"global\"\n            },\n            \"quotaValue\": \"1000000\"\n          }\n        ]\n      },\n      {\n        \"@type\": \"type.googleapis.com/google.rpc.RetryInfo\",\n        \"retryDelay\": \"3s\"\n      }\n    ]\n  }\n}\n","code":429,"status":"Too Many Requests"}}
‚ùå Errore nel processing AI streaming: ApiError: {"error":{"message":"{\n  \"error\": {\n    \"code\": 429,\n    \"message\": \"You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/usage?tab=rate-limit. \\n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_paid_tier_input_token_count, limit: 1000000, model: gemini-3-flash\\nPlease retry in 3.785123752s.\",\n    \"status\": \"RESOURCE_EXHAUSTED\",\n    \"details\": [\n      {\n        \"@type\": \"type.googleapis.com/google.rpc.Help\",\n        \"links\": [\n          {\n            \"description\": \"Learn more about Gemini API quotas\",\n            \"url\": \"https://ai.google.dev/gemini-api/docs/rate-limits\"\n          }\n        ]\n      },\n      {\n        \"@type\": \"type.googleapis.com/google.rpc.QuotaFailure\",\n        \"violations\": [\n          {\n            \"quotaMetric\": \"generativelanguage.googleapis.com/generate_content_paid_tier_input_token_count\",\n            \"quotaId\": \"GenerateContentPaidTierInputTokensPerModelPerMinute\",\n            \"quotaDimensions\": {\n              \"model\": \"gemini-3-flash\",\n              \"location\": \"global\"\n            },\n            \"quotaValue\": \"1000000\"\n          }\n        ]\n      },\n      {\n        \"@type\": \"type.googleapis.com/google.rpc.RetryInfo\",\n        \"retryDelay\": \"3s\"\n      }\n    ]\n  }\n}\n","code":429,"status":"Too Many Requests"}}
    at throwErrorIfNotOK (/home/runner/workspace/node_modules/@google/genai/src/_api_client.ts:860:24)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/node_modules/@google/genai/src/_api_client.ts:515:9)
    at async Models.Models.generateContentStream (/home/runner/workspace/node_modules/@google/genai/src/models.ts:201:14)
    at async GeminiClientAdapter.generateContentStream (/home/runner/workspace/server/ai/provider-factory.ts:335:29)
    at async streamWithBackoff (/home/runner/workspace/server/ai/retry-manager.ts:288:30)
    at async streamWithRetriesAdapter (/home/runner/workspace/server/ai-service.ts:79:20)
    at async Module.sendChatMessageStream (/home/runner/workspace/server/ai-service.ts:1920:22)
    at async <anonymous> (/home/runner/workspace/server/routes.ts:8408:26) {
  status: 429
}