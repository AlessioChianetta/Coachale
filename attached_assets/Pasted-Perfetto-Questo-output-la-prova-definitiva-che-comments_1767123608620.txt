Perfetto. Questo output Ã¨ la prova definitiva che:

âœ… comments Ãˆ ATTIVO
âœ… Meta STA tentando di inviarli
âœ… La subscription non Ã¨ il problema

Quindi ora possiamo dirlo senza dubbi:

ğŸ”´ Il problema Ã¨ al 100% nel tuo webhook endpoint (runtime / parsing / risposta HTTP)
NON piÃ¹ in Meta.

Adesso andiamo chirurgici.

âœ… Cosa sappiamo con certezza

Dal JSON:

object: instagram âœ…

active: true âœ…

fields: comments âœ…

callback_url corretto âœ…

ğŸ‘‰ Meta invia i webhook commenti a quellâ€™URL. Punto.

Se tu non li vedi, succede UNA di queste 3 cose.

ğŸ”´ CAUSA 1 (70% dei casi): il webhook RICEVE i commenti ma TU LI SCARTI

Errore classico: il codice gestisce solo entry.messaging.

Esempio tipico (sbagliato):

if (entry.messaging) {
  // DM
}


Ma i commenti arrivano cosÃ¬:

entry.changes[0].field === "comments"

âœ… Fix minimo (temporaneo, per debug)

Metti questo handler brutale per 5 minuti:

app.post("/api/instagram/webhook", (req, res) => {
  console.log("ğŸ”¥ RAW WEBHOOK:", JSON.stringify(req.body, null, 2));
  res.sendStatus(200);
});


Poi:

Pubblica un post nuovo

Commenta

Guarda la console

Se li vedi â†’ bug nel parsing
Se NON li vedi â†’ vai a causa 2

ğŸ”´ CAUSA 2 (molto comune): NON rispondi 200 OK in tempo

Meta Ã¨ spietata:

se il webhook:

va in timeout

risponde 404 / 500

lancia eccezioni

Meta continua a inviare DM

ma smette di inviare commenti (senza avvisare)

âš ï¸ I commenti sono piÃ¹ fragili dei messaggi.

Test immediato

Nel log del server controlla che:

OGNI request webhook

ritorni 200 OK in < 2â€“3 secondi

ğŸ‘‰ Anche se dentro fai errori, rispondi subito 200, poi processa async.

ğŸ”´ CAUSA 3 (subdola): stai testando un tipo di commento che NON genera eventi

Instagram NON manda webhook per:

âŒ commenti dellâ€™owner (te stesso)

âŒ commenti modificati

âŒ commenti rimossi

âŒ commenti su post collaborativi

âŒ commenti su post sponsorizzati (ADS)

âŒ commenti su reel remix / repost

âœ… Test valido (fallo cosÃ¬)

Post NUOVO, semplice

Commento da ALTRO account

Testo semplice: test

Account non shadowbanned

ğŸ§ª Test definitivo (non sbaglia)

Fai ESATTAMENTE questo:

Sostituisci temporaneamente il webhook con il logger RAW

Pubblica un post ora

Commenta da un altro account

Guarda i log

Risultati possibili
Cosa succede	Significa
Vedi il payload	parsing bug
Non vedi nulla	webhook non risponde 200
Vedi errori 500	Meta ha sospeso i commenti
DM arrivano	conferma che endpoint Ã¨ giusto
ğŸ§  Nota importante (Replit / tunnel)

Vedo che usi un URL tipo:

spock.replit.dev


âš ï¸ Se:

il processo va a sleep

il cold start supera 10â€“15s

la request webhook arriva durante lo sleep

ğŸ‘‰ Meta droppa i commenti.

Consiglio per test:

tieni il server sempre awake

oppure rispondi 200 immediato prima di qualunque logica

TL;DR finale (verdetto)
Possibile causa	Stato
Subscription	âœ… OK
Meta	âœ… invia
Config app	âœ… OK
Webhook handler	âŒ problema
Parsing	âŒ probabile
HTTP 200	âŒ probabile