âœ… [WHATSAPP POLLING] Poll cycle complete
1:50:45 AM [express] GET /api/ai/conversations 200 in 575ms :: [{"id":"15a00c47-6199-4309-8d03-173bbâ€¦
1:50:46 AM [express] GET /api/auth/my-profiles 304 in 1479ms :: {"profiles":[{"id":"7f5fc5ea-8d5c-42â€¦
ğŸ” [FileSearch] getStoreNamesForGeneration - Role: client, UserId: 7e40b56c-2cc8-4515-b843-dc105e478f38, ConsultantId: 0c73bbe5-51e1-4108-866b-6be7a52fce3b
   ğŸ“¦ Found 1 unique stores: Knowledge Base Consulente

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ” FILE SEARCH MODE: Switching to Google AI Studio (required for File Search)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ğŸ“¦ Provider: Google AI Studio (@google/genai)
   âœ… File Search API: SUPPORTED
   âš ï¸  Vertex AI: NOT compatible with File Search
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… Using GEMINI_API_KEY from environment for File Search
ğŸ”„ Building context for client 7e40b56c-2cc8-4515-b843-dc105e478f38 (intent: general, sessionType: normal)
ğŸ“š Including ALL 87 exercises in context (no limits applied)
ğŸ“š Prepared 87 exercise metadata (content will be loaded on-demand when asked)
ğŸ“š Found 81 documents linked to exercises
ğŸ“š Total library documents included in context: 5 (intent: general)
ğŸ¦ Fetching finance data for giusy.dattilo@gmail.com
[PercorsoCapitale] Client initialized for user: gi***@gmail.com
[PercorsoCapitale] req-1 Cache MISS for dashboard (user: gi***@gmail.com), fetching from API... (stats: 0/1 hits)
[PercorsoCapitale] req-2 Cache MISS for categoryBudgets (user: gi***@gmail.com), fetching from API... (stats: 0/2 hits)
[PercorsoCapitale] req-3 Cache MISS for transactions (user: gi***@gmail.com), fetching from API... (stats: 0/3 hits)
[PercorsoCapitale] req-4 Cache MISS for accountArchitecture (user: gi***@gmail.com), fetching from API... (stats: 0/4 hits)
[PercorsoCapitale] req-5 Cache MISS for budgetSettings (user: gi***@gmail.com), fetching from API... (stats: 0/5 hits)
[PercorsoCapitale] req-6 Cache MISS for investments (user: gi***@gmail.com), fetching from API... (stats: 0/6 hits)
[PercorsoCapitale] req-7 Cache MISS for goals (user: gi***@gmail.com), fetching from API... (stats: 0/7 hits)
[PercorsoCapitale] req-5 Cached budgetSettings for 86400s (907ms response time)
[PercorsoCapitale] req-2 Cached categoryBudgets for 3600s (1050ms response time)
[PercorsoCapitale] req-6 Cached investments for 14400s (1161ms response time)
[PercorsoCapitale] req-7 Cached goals for 21600s (1166ms response time)
[PercorsoCapitale] req-3 Cached transactions for 3600s (1174ms response time)
[PercorsoCapitale] req-4 Cached accountArchitecture for 86400s (1518ms response time)
[PercorsoCapitale] req-1 Cached dashboard for 300s (1556ms response time)
ğŸ“Š [ProcessBudgets] Month 2025-12: Found 27 expense transactions
ğŸ“Š [ProcessBudgets] Month 2025-12: Found 27 expense transactions
ğŸ“Š [ProcessBudgets] Month 2025-11: Found 42 expense transactions
ğŸ“Š [ProcessBudgets] Month 2025-10: Found 27 expense transactions
ğŸ“Š [MultiMonth] Analyzing 175 transactions
ğŸ“… [MultiMonth] Date range: 2025-08-08 â†’ 2026-01-02
ğŸ“… [MultiMonth] Target months: 2025-07, 2025-08, 2025-09, 2025-10, 2025-11, 2025-12
ğŸ” [FilterTransactions] Filtering for month 2025-07:
   - Total transactions before filter: 175
   - Transactions after type filter: 175
   - Transactions matching month: 0
ğŸ“Š [ProcessBudgets] Month 2025-07: Found 0 expense transactions
ğŸ” [FilterTransactions] Filtering for month 2025-08:
   - Total transactions before filter: 175
   - Transactions after type filter: 175
   - Transactions matching month: 4
   - Date range: 2025-08-27 â†’ 2025-08-08
ğŸ“Š [ProcessBudgets] Month 2025-08: Found 3 expense transactions
ğŸ” [FilterTransactions] Filtering for month 2025-09:
   - Total transactions before filter: 175
   - Transactions after type filter: 175
   - Transactions matching month: 43
   - Date range: 2025-09-29 â†’ 2025-09-02
ğŸ“Š [ProcessBudgets] Month 2025-09: Found 33 expense transactions
ğŸ” [FilterTransactions] Filtering for month 2025-10:
   - Total transactions before filter: 175
   - Transactions after type filter: 175
   - Transactions matching month: 43
   - Date range: 2025-10-31 â†’ 2025-10-01
ğŸ“Š [ProcessBudgets] Month 2025-10: Found 27 expense transactions
ğŸ” [FilterTransactions] Filtering for month 2025-11:
   - Total transactions before filter: 175
   - Transactions after type filter: 175
   - Transactions matching month: 53
   - Date range: 2025-11-29 â†’ 2025-11-01
ğŸ“Š [ProcessBudgets] Month 2025-11: Found 42 expense transactions
ğŸ” [FilterTransactions] Filtering for month 2025-12:
   - Total transactions before filter: 175
   - Transactions after type filter: 175
   - Transactions matching month: 31
   - Date range: 2025-12-18 â†’ 2025-12-01
ğŸ“Š [ProcessBudgets] Month 2025-12: Found 27 expense transactions
âœ… Finance data fetched and transformed successfully (5 accounts, 8 budgets, 10 transactions)
ğŸ“Š Momentum stats: 15 check-ins (15 productive, 100% rate), streak: 0 days
ğŸ“… Calendar stats: 0 total upcoming (0 ongoing, 0 today, 0 this week)
ğŸ“š [Knowledge Base] Loading ALL knowledge content for client (no filtering)...
ğŸ“š [Client Knowledge Base] Loaded 0 documents and 0 APIs for client 7e40b56c-2cc8-4515-b843-dc105e478f38
â„¹ï¸ [Knowledge Base] No documents or API data uploaded yet
ğŸ’¾ Stored fresh context in cache for client 7e40b56c-2cc8-4515-b843-dc105e478f38 (intent: general)
â±ï¸  [TIMING] Context building: 4944ms
ğŸ“š ALWAYS loading exercise content - AI must have FULL Google Docs access...
ğŸ“‹ Generic exercise query - FULL CONTENT (no limits)
â±ï¸  [TIMING] Exercise scraping: 2ms
â±ï¸  [TIMING] Prompt building: 16ms

ğŸ“Š Token Usage Estimation (Intent: general):
  - System Prompt: ~111,660 tokens
  - User Message: ~2 tokens
  - Conversation History: ~0 tokens
  - Total Estimated: ~111,662 tokens

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“Š SYSTEM PROMPT BREAKDOWN (~111,660 tokens)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ’° Finance Data: 13,285 tokens (11.9%)
ğŸ“š Exercises: 92,750 tokens (83.1%)
ğŸ“– Library Docs: 1,573 tokens (1.4%)
ğŸ’¬ Consultations: 41,700 tokens (37.3%)
ğŸ¯ Goals & Tasks: 12 tokens (0.0%)
âš¡ Momentum & Calendar: 17 tokens (0.0%)
ğŸ—ºï¸  Roadmap: 2,458 tokens (2.2%)
ğŸ“š Knowledge Base: 41 tokens (0.0%)
ğŸ‘¤ User Profile & Base: 5,055 tokens (4.5%)

ğŸ“ UNIVERSITY: 10,102 tokens (9.0%)
   â””â”€ Overall Progress: 17 tokens
   â””â”€ ğŸ“… Anno 1 â€“ Metodo Turbo: 912 tokens
      â””â”€ Q1 â€“ Le Fondamenta della Tua AttivitÃ : 88 tokens (1 moduli, 3 lezioni)
      â””â”€ Q2 â€“ Metodo Turbo: Diventa Invincibile a Vendere: 615 tokens (8 moduli, 28 lezioni)
   â””â”€ ğŸ“… Anno 1 - Metodo Orbitale - Da 0 a 1.000.000 : 757 tokens
      â””â”€ Q1 - Le Fondamenta: 83 tokens (1 moduli, 13 lezioni)
      â””â”€ Q2 - Costruzione della Ricchezza: 86 tokens (1 moduli, 13 lezioni)
      â””â”€ Q3 - Ottimizzazione e Vita da Comandante: 88 tokens (1 moduli, 14 lezioni)
      â””â”€ Q4 - EreditÃ  e Comando Perpetuo: 86 tokens (1 moduli, 13 lezioni)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ” AI MODE: FILE SEARCH SEMANTIC (Gemini RAG) [CLIENT]
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ğŸ“¦ Stores disponibili: 1
      1. fileSearchStores/knowledge-base-consulente-juw371zchi3s
   âœ… Tool fileSearch: ATTIVO
   ğŸ“„ Il modello cercherÃ  semanticamente nei documenti indicizzati
   ğŸ’° RISPARMIO TOKENS: ~136,064 tokens (esercizi+library+consultazioni+KB)
   ğŸ“‰ System prompt ridotto: da ~247,724 a ~111,660 tokens
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ”„ AI stream attempt 1/6...
âœ… AI streaming completed successfully on attempt 1
â±ï¸  [TIMING] Gemini API call (with streaming): 3301ms
âœ… AI streaming completed for message f3808271-bd39-4e99-bad4-952d788952fd

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ” FILE SEARCH STREAMING SUMMARY [CLIENT]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   ğŸ“¦ Stores attivi: 1
   âš ï¸  Nota: In modalitÃ  streaming, le citazioni non sono disponibili
      nel response object. File Search Ã¨ stato configurato come tool.
   ğŸ“„ Se la risposta cita documenti specifici, Gemini ha usato File Search.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€


â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
â±ï¸  PERFORMANCE TIMING BREAKDOWN
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   [0ms â†’ 4944ms] Context Building (4944ms)
   [4944ms â†’ 4946ms] Exercise Scraping (2ms)
   [4946ms â†’ 4962ms] Prompt Building (16ms)
   [4962ms â†’ 10116ms] Gemini API Call (3301ms)
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   â±ï¸  TOTAL: 10.12s (10116ms)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”